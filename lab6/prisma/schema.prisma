generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model roles {
  id        Int         @id @default(autoincrement())
  name      String      @unique @db.VarChar(20)
  user_role user_role[]
}

model customers {
  id             BigInt           @id @default(autoincrement())
  username       String           @unique @db.VarChar(255)
  password_hash  String           @db.VarChar(255)
  email          String           @unique @db.VarChar(255)
  first_name     String?          @db.VarChar(255)
  last_name      String?          @db.VarChar(255)
  phone          String?          @db.VarChar(20)
  created_at     DateTime?        @default(now()) @db.Timestamp(6)
  user_role      user_role[]
  addresses      addresses[]
  orders         orders[]
  reviews        reviews[]
  shopping_carts shopping_carts?
  wishlists      wishlists[]
}

model user_role {
  user_id   BigInt
  role_id   Int
  customers customers @relation(fields: [user_id], references: [id], onDelete: Cascade)
  roles     roles     @relation(fields: [role_id], references: [id], onDelete: Cascade)

  @@id([user_id, role_id])
}

model categories {
  id          BigInt    @id @default(autoincrement())
  name        String    @db.VarChar(255)
  description String?   @db.Text
  created_at  DateTime? @default(now()) @db.Timestamp(6)
  updated_at  DateTime? @default(now()) @db.Timestamp(6)
  products    products[]
}

model brands {
  id          BigInt    @id @default(autoincrement())
  name        String    @unique @db.VarChar(255)
  description String?   @db.Text
  website     String?   @db.VarChar(255)
  created_at  DateTime? @default(now()) @db.Timestamp(6)
  products    products[]
}

model products {
  id             BigInt           @id @default(autoincrement())
  category_id    BigInt?
  brand_id       BigInt?
  name           String           @db.VarChar(255)
  description    String?          @db.Text
  price          Decimal          @db.Decimal(10, 2)
  stock_quantity Int              @default(0)
  is_active      Boolean          @default(true)
  created_at     DateTime?        @default(now()) @db.Timestamp(6)
  updated_at     DateTime?        @default(now()) @db.Timestamp(6)
  categories     categories?      @relation(fields: [category_id], references: [id], onDelete: SetNull)
  brands         brands?          @relation(fields: [brand_id], references: [id], onDelete: SetNull)
  order_items    order_items[]
  reviews        reviews[]
  cart_items     cart_items[]
  wishlist_items wishlist_items[]
}

model addresses {
  id          BigInt    @id @default(autoincrement())
  customer_id BigInt
  street      String    @db.VarChar(255)
  city        String    @db.VarChar(255)
  state       String    @db.VarChar(255)
  postal_code String    @db.VarChar(20)
  country     String    @db.VarChar(255)
  is_default  Boolean?  @default(false)
  customers   customers @relation(fields: [customer_id], references: [id], onDelete: Cascade)
  orders      orders[]
}

model orders {
  id                  BigInt        @id @default(autoincrement())
  customer_id         BigInt
  order_date          DateTime      @default(now()) @db.Timestamp(6)
  status              String        @db.VarChar(50)
  total_amount        Decimal       @db.Decimal(10, 2)
  shipping_address_id BigInt?
  customers           customers     @relation(fields: [customer_id], references: [id], onDelete: Cascade)
  addresses           addresses?    @relation(fields: [shipping_address_id], references: [id], onDelete: SetNull)
  order_items         order_items[]
  payments            payments?
}

model order_items {
  id             BigInt    @id @default(autoincrement())
  order_id       BigInt
  product_id     BigInt?
  quantity       Int
  price_per_unit Decimal   @db.Decimal(10, 2)
  orders         orders    @relation(fields: [order_id], references: [id], onDelete: Cascade)
  products       products? @relation(fields: [product_id], references: [id], onDelete: SetNull)
}

model payments {
  id             BigInt   @id @default(autoincrement())
  order_id       BigInt   @unique
  payment_date   DateTime @default(now()) @db.Timestamp(6)
  payment_method String   @db.VarChar(50)
  status         String   @db.VarChar(50)
  amount         Decimal  @db.Decimal(10, 2)
  orders         orders   @relation(fields: [order_id], references: [id], onDelete: Cascade)
}

model reviews {
  id          BigInt    @id @default(autoincrement())
  product_id  BigInt
  customer_id BigInt
  rating      Int
  comment     String?   @db.Text
  review_date DateTime  @default(now()) @db.Timestamp(6)
  products    products  @relation(fields: [product_id], references: [id], onDelete: Cascade)
  customers   customers @relation(fields: [customer_id], references: [id], onDelete: Cascade)
}

model shopping_carts {
  id          BigInt       @id @default(autoincrement())
  customer_id BigInt       @unique
  created_at  DateTime?    @default(now()) @db.Timestamp(6)
  customers   customers    @relation(fields: [customer_id], references: [id], onDelete: Cascade)
  cart_items  cart_items[]
}

model cart_items {
  id             BigInt         @id @default(autoincrement())
  cart_id        BigInt
  product_id     BigInt
  quantity       Int
  shopping_carts shopping_carts @relation(fields: [cart_id], references: [id], onDelete: Cascade)
  products       products       @relation(fields: [product_id], references: [id], onDelete: Cascade)

  @@unique([cart_id, product_id])
}

model wishlists {
  id             BigInt           @id @default(autoincrement())
  customer_id    BigInt
  name           String           @db.VarChar(100) @default("My Wishlist")
  created_at     DateTime?        @default(now()) @db.Timestamp(6)
  customers      customers        @relation(fields: [customer_id], references: [id], onDelete: Cascade)
  wishlist_items wishlist_items[]
}

model wishlist_items {
  id          BigInt    @id @default(autoincrement())
  wishlist_id BigInt
  product_id  BigInt
  added_at    DateTime? @default(now()) @db.Timestamp(6)
  wishlists   wishlists @relation(fields: [wishlist_id], references: [id], onDelete: Cascade)
  products    products  @relation(fields: [product_id], references: [id], onDelete: Cascade)

  @@unique([wishlist_id, product_id])
}
